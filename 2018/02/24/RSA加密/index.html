<!DOCTYPE html>
<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?cf6db1de52b3cb4093686c920c8e3f7e";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>
<html style="display: none;" lang="zh">
    <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.4.0 -->
    <script>window.materialVersion = "1.4.0"</script>

    <!-- Title -->
    
    <title>
        
            RSA加密 | 
        
        Stefenson&#39;s Blog
    </title>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
    
    
    
    
    
    
    
    
    

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Stefenson Wang">
    <meta name="description" itemprop="description" content>
    <meta name="keywords" content=",加密,数论,RSA,中国剩余定理,欧拉定理,欧拉函数">

    <!-- Site Verification -->
    
    

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Stefenson&#39;s Blog">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://yoursite.com">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="RSA加密 | Stefenson&#39;s Blog">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content>
    <meta property="og:article:tag" content="加密"> <meta property="og:article:tag" content="数论"> <meta property="og:article:tag" content="RSA"> <meta property="og:article:tag" content="中国剩余定理"> <meta property="og:article:tag" content="欧拉定理"> <meta property="og:article:tag" content="欧拉函数"> 

    
        <meta property="article:published_time" content="2月 24, 2018">
        <meta property="article:modified_time" content="7月 09, 2020">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="RSA加密 | Stefenson&#39;s Blog">
    <meta name="twitter:description" content>
    <meta name="twitter:image" content="/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="http://yoursite.com">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://yoursite.com/2018/02/24/RSA加密/index.html">
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Stefenson&#39;s Blog",
        "logo": "/img/favicon.png"
    },
    "author": {
        "@type": "Person",
        "name": "Stefenson Wang",
        "image": {
            "@type": "ImageObject",
            "url": "/img/favicon.png"
        },
        "description": "一个渣渣程序员的笔记"
    },
    "headline": "RSA加密",
    "url": "http://yoursite.com/2018/02/24/RSA加密/index.html",
    "datePublished": "2月 24, 2018",
    "dateModified": "7月 09, 2020",
    "description": "",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://yoursite.com"
    }
}
</script>


    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+materialVersion+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(data&&data.indexOf(versionString)===-1){lsloader.removeLS(key)}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload){cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}code=code.split(versionString)[1];if(/\.js?.+$/.test(versionNumber)){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload)}};lsloader.requestResource=function(name,path,cssonload){var that=this;if(/\.js?.+$/.test(path)){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else if(/\.css?.+$/.test(path)){this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>
    <!-- Import CSS & jQuery -->
    
        <style id="css/material.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/material.min.css","/css/material.min.css?fJTiM/K1J3dWIruo3pxtAw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        <style id="css/style.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/style.min.css","/css/style.min.css?hslYKgKmx9IuZcHTcpHD1Q==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        
            <style id="/css/fontawesome.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("/css/fontawesome.min.css","/css/fontawesome.min.css?JpVQUwzBJ7aqWjWSWn3mzg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        
        
        <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">


        <script>lsloader.load("js/jquery.min.js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==")</script>
    
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Analytics -->
    

    <!-- Custom Head -->
    
</head>

    <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
    <style type="text/css">
    /*重新定义gitment样式*/
    .gitment-editor-tab {
        margin: 0px;
    }
    .gitment-editor-main {
        background-color: white;
    }
    .gitment-comment-main {
        background-color: white;
    }
    .gitment-editor-submit:enabled {
        background-color: black;
    }
    .gitment-editor-submit:disabled {
        background-color: gray;
    }

    /*重新定义MathJax样式，去掉框线*/
    .MathJax {
        outline: 0;
    }

    /*重新定义代码块样式*/
    #post-content pre {
        color: rgb(255, 240, 192);
        background-color: rgba(17, 17, 31, 1);
        /* border-radius: 3px; */
    }
    #post-content pre code {
        font-family: "Consolas","Monaco";
    }

    /*重新定义表格样式*/
    #post-content table td {
        border: 1px solid rgb(156, 156, 156);
    }
    #post-content table th {
        color: white;
        background-color: rgba(128, 128, 128, 0.5);
        border: 1px solid rgb(156, 156, 156);
    }

    /*重新定义头部Tags标签样式*/
    #scheme-Isolation .post_entry-tags-head-list {
        padding: 0;
        margin: 0;
    }
    #scheme-Isolation .post_entry-tags-head-list-item {
        list-style: none;
        float: left;
        font-size: 11px;
        border: 1px solid #c2c2c2;
        letter-spacing: 1px;
        border-radius: 3px;
        padding-right: 6px;
        padding-left: 8px;
        margin-top: 8px;
        margin-right: 8px;
        text-align: center;
        -webkit-appearance: none;
    }
    #scheme-Isolation .post_entry-tags-head-list-count {
        margin-left: 2px;
        color: #BBBBBB;
    }
    #scheme-Isolation .post_entry-tags-head-list-item a {
        text-decoration: none;
        color: white;
        font-weight: 500;
    }
    </style>
    
        <body id="scheme-Isolation" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                
                    <!-- Isolation Header -->
                    <header class="header">
    <div class="header-wrapper">
        <!-- Header Copyright -->
        <div class="header-copyright" style="bottom: -150px">
            <div class="header-site">
                ©&nbsp;
                <script type="text/javascript">
                    var fd = new Date();
                    document.write(fd.getFullYear());
                </script>
                &nbsp;Stefenson's Blog
            </div>
            <!--
            I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright.
            It will not impact the appearance and can give developers a lot of support :)

            很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
            它不会影响美观并可以给开发者很大的支持。 :)
            -->
            <div>
                Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a>
                <br>
                Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a>
                <br>
                <br>友情链接：
                <br>某可爱的司机的博客 <a href="https://blog.chionlab.moe" class="footer-develop-a">Chion82的未来道具研究所</a>
                <br>某可爱的日天的博客 <a href="https://sunskyxh.github.io" class="footer-develop-a">香鸡鸡的小窝</a>
                <br>某可爱的miruku博客 <a href="https://mirukuchan.github.io" class="footer-develop-a">世界尽头的百货公司</a>
                <br>某可爱的钟叔的博客 <a href="https://kurumichann.github.io" class="footer-develop-a">kurumi's blog(miruku?)</a>
            </div>
        </div>

        <!-- Header Title -->
        <span class="header-title header-item">
            <a href="/" title="Stefenson&#39;s Blog">
                Stefenson&#39;s Blog
            </a>
        </span>

        <p class="header-slogan header-item">
        
            
                一个渣渣程序员的笔记
            
        
        </p>

        <!-- Header Nav -->
        <nav class="header-nav header-item">
            <span class="header-nav-item">
                <a href="/" title="Home">
                    <span>主页</span>
                </a>
            </span>

            <!-- Pages  -->
            
                <span class="header-nav-item">
                    <a href="/about" title="About">
                        <span>About</span>
                    </a>
                </span>
            
            <span class="header-nav-item">
                <a id="BackgroundSwitch" href="javascript:switchbg()" title="暂停背景">
                    <span id="BackgroundSwitchTitle">暂停背景</span>
                </a>
            </span>
            <span class="header-nav-item">
                <a id="MouseTrack" href="javascript:mousetrack()" title="追踪鼠标">
                    <span id="BackgroundSwitchTitle">追踪鼠标</span>
                </a>
            </span>
        </nav>

        <!-- Header SNS isolate-sns_list.ejs -->

        <!-- Header Nav Pages Level2 -->
        <nav class="header-nav header-item">
            
                <span class="header-nav-item">
                    <a href="/game" title="Game &amp; Demo">
                        <span>Game &amp; Demo</span>
                    </a>
                </span>
            
        </nav>
    </div>
</header>

                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    

                    <!-- Post TOC -->

    



<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col" style="background-color: rgba(255,255,255,0.6)">

                <!-- Post Header(Thumbnail & Title) -->
                


    <!-- Isolation Post Header -->
    <!-- Post thumbnail -->
    
        <!-- Post Header Info -->
        <div class="post-header_info without-thumbnail">
            <!-- Author Avatar & Name -->
            <a href="/about" style="text-decoration: none; color: #333">
                <img src="/img/avatar.png" class="avatar-img" width="44px" height="44px" alt="Stefenson Wang's avatar">
                <span class="name-span">Stefenson Wang</span>
            </a>
        </div>

        <!-- Null Thumbnail -->
        <div class="post_thumbnail-null">
    
        </div>



                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    

    
        <div class="post-content_wrapper">
            <p class="post-title">
                RSA加密
            </p>
            <p>今天主要介绍的是RSA加密。</p>
<p>RSA加密是目前世界上最流行的非对称加密，它名字的来源于它的三位父亲：罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman），他们在1977年提出了RSA加密并且在1987年7月首次在美国公布，RSA来源于他们的姓氏开头字母。</p>
<p>RSA加密内容其实很简单，先给出RSA加密的步骤</p>
<ol>
<li>寻找两个质数\(p\)、\(q\)（尽量大一点）。</li>
<li>令\(n=pq,\;\phi(n)=(p-1)(q-1)\) 。</li>
<li>找一个数\(e\)，使得\(e\)与\(\phi(n)\)互质。</li>
<li>找一个数\(d\)，使得\(de\;\%\;\phi(n)=1\)。</li>
</ol>
<p>以上步骤得出了RSA的一组公钥和私钥，公钥为\((e, n)\)，私钥为\((d, n)\)。<br>如果原始数据为\(D\)，则加密数据\(S\)的计算方法为：<br>$$S=D^e\;\%\;n$$<br>解密数据的计算方法为：<br>$$D=S^d\;\%\;n$$</p>
<blockquote>
<p><em>PS：RSA加密要求 \(D&lt;n\)，因为根据算法过程可知，最终解密时，解密得到的结果为 \(n\)的余数，余数不可能比 \(n\)大，所以 \(D&lt;n\)。</em></p>
</blockquote>
<p>是不是很简单？</p>
<h6 id="如果你只是寻找RSA加密的方法结论，那么以上内容就是全部了，下面的就不用看了233。"><a href="#如果你只是寻找RSA加密的方法结论，那么以上内容就是全部了，下面的就不用看了233。" class="headerlink" title="如果你只是寻找RSA加密的方法结论，那么以上内容就是全部了，下面的就不用看了233。"></a><em>如果你只是寻找RSA加密的方法结论，那么以上内容就是全部了，下面的就不用看了233。</em></h6><p>从这个过程中也可以看出这里非对称加密的意思，普通的加密中，加密方和解密方都是用的同一个加密钥匙，但是RSA中二者的钥匙却不一样。<br>是不是很神奇？</p>
<p>可能你会想：“WTF，为什么会有这种神奇的算法？”，下面我们就从RSA加密基础的地方一点一点讲解这个算法的来历。</p>
<h3 id="模运算基础"><a href="#模运算基础" class="headerlink" title="模运算基础"></a>模运算基础</h3><p>首先介绍一下什么是模运算。<br>模运算是数论中引入的一个概念，表示该数在所给的数字范围内的一个特征值。<br>这个特征值计算方法就是除以所给的数计算余数。<br>所以说，模运算其实就是余数，不过在数论中起了一个高大上的名字而已。<br>它的表示方法，这里我只介绍我用的比较多的方法：<br>$$x\equiv a\;(mod\;n)$$<br>该式子表示\(x\)除以\(n\)的余数为\(a\)，相当于\(x\;\%\;n=a\)。<br>模运算有下面这些性质：</p>
<ul>
<li>如果\(a\equiv b\;(mod\;n)\)，则\(b\equiv a\;(mod\;n)\)</li>
<li>如果\(a\equiv b\;(mod\;n)\)，则\(a + kn\equiv b\;(mod\;n)\)</li>
<li>如果\(a\equiv b\;(mod\;n)\)，\(b\equiv c\;(mod\;n)\)，则\(a\equiv c\;(mod\;n)\)</li>
<li>如果\(a\equiv b\;(mod\;n)\)，则\(ax\equiv bx\;(mod\;n)\)</li>
<li><strong> 如果\(ax\equiv bx\;(mod\;n)\)，且\(x,n\)互质，则\(a\equiv b\;(mod\;n)\) * </strong></li>
<li>如果\(a\equiv b\;(mod\;n)\)，\(c\equiv d\;(mod\;n)\)，则\(a\pm c\equiv b\pm d\;(mod\;n)\)，\(ac\equiv bd\;(mod\;n)\)</li>
<li>如果\(a\equiv b\;(mod\;n)\)，\(n=m_1 m_2 … m_n\)，则\(a\equiv b\;(mod\;m_1)\)，\(a\equiv b\;(mod\;m_2)…a\equiv b\;(mod\;m_n)\)</li>
</ul>
<p>其实还有很多性质，这里就不再一一列举。<br>上面这些性质证明过程都比较简单，这里简单说一下证明思路：\(a\equiv b\;(mod\;n)\)换一种表达方式就是\(a=kn + b\)，通过这个转换这些性质都能够得到证明。<br>关于 * 标记的性质，这里需要解释一下：</p>
<blockquote>
<p>如果\(ax\equiv bx\;(mod\;n)\)，那么\(ax = kn + bx\)，则有\(a = \frac{kn}{x} + b\)，由于\(a\)是整数，所以\(\frac{kn}{x}\)是整数，又因为\(x,n\)互质，所以\(k = tx\)，所以\(\frac{kn}{x} = tn\)，所以\(a = tn + b\)，所以\(a\equiv b\;(mod\;n)\)。</p>
</blockquote>
<p>模运算是RSA证明过程的基石，必须理解。</p>
<h3 id="扩展欧几里得算法"><a href="#扩展欧几里得算法" class="headerlink" title="扩展欧几里得算法"></a>扩展欧几里得算法</h3><p>欧几里得算法即辗转相除法，求两个数最大公约数的算法，这里记求两数最大公约数的函数为\(gcd(x, y)\)。<br>扩展欧几里得算法描述为：两个整数\(a, b\)，必存在参数\(x, y\)使得\(ax + by = gcd(a, b)\)。</p>
<p>扩展欧几里得算法其实就是欧几里得算法的逆过程，举例\(37\)和\(23\)：</p>
<blockquote>
<p>\(\begin{align} 37&amp;=23\times1+14 \\ 23&amp;=14\times1+9 \\ 14&amp;=9\times1+5 \\ 9&amp;=5\times1+4 \\ 5&amp;=4\times1+1 \\ 4&amp;=1\times4 \end{align}\)</p>
</blockquote>
<p>反推：</p>
<blockquote>
<p>\(\begin{align} 1&amp;=5-4 \\&amp;=5+5-9 \\&amp;=2\times(14-9)-9 \\&amp;=2\times14-3\times(23-14) \\&amp;=5\times(37-23)-3\times23  \\&amp;=5\times37-8\times23 \end{align}\)</p>
</blockquote>
<p>每一个欧几里得算法计算过程都能如此反推，所以扩展欧几里得算法成立。</p>
<p>扩展欧几里得算法主要用于证明模逆元的存在必然性，需要了解一下。</p>
<h3 id="模逆元-模倒数"><a href="#模逆元-模倒数" class="headerlink" title="模逆元/模倒数"></a>模逆元/模倒数</h3><p>整数\(a\)在模\(n\)上的逆元\(b\)定义如下：<br>$$ab\equiv 1\;(mod\;n)$$<br>其中\(a\)与\(n\)互质，否则\(b\)不存在。<br><strong>证明：</strong></p>
<ul>
<li>由扩展欧几里得算法，有\(ax+ny=gcd(a,n)\)。</li>
<li>如果\(a\)与\(n\)互质，则\(gcd(a,n)=1\)，所以\(ax+ny=1\)。</li>
<li>在模\(n\)上，\(ax+ny\equiv ax\equiv 1\;(mod\;n)\)，则由定义可知，\(x\)即为\(a\)在模\(n\)上的逆元。</li>
<li>如果\(a\)与\(n\)不互质，则\(gcd(a,n)=r\)。</li>
<li>设\(a=pr\;n=qr\)，根据求最大公约数过程易得\(p,q\)互质，假设存在\(z\)使得\(az\equiv 1\;(mod\;n)\)，我们会得到\(az=kn+1\)。</li>
<li>把\(a=pr\;n=qr\)代入式子得到\(pr·z=qr·k+1\)，同时除以\(r\)有\(pz=qk+ \frac{1}{r}\)，由于\(r\neq 1\)，所以\(\frac{1}{r}\)不是整数，假设不成立。</li>
</ul>
<p>由以上过程可知，\(a\)与\(n\)互质是\(a\)在模\(n\)上存在逆元的充要条件。</p>
<p>模逆元会存在多个，假如\(a\)在模\(n\)的一个逆元为\(a^{-1}\)，那么所有\(a\)在模\(n\)的逆元可用如下通式计算：<br>$$a^{-1}_k = a^{-1} + kn$$<br>证明很简单：如果\(a·a^{-1}\equiv 1\;(mod\;n)\)，则由\(a(a^{-1}+kn)=a·a^{-1}+akn\)可得\(a(a^{-1}+kn)\equiv a·a^{-1}+akn\equiv a·a^{-1}\equiv 1\;(mod\;n)\)，所以\(a^{-1}_k = a^{-1} + kn\)为\(a\)在模\(n\)的逆元通解。</p>
<p>这个概念在后面中国剩余定理和欧拉定理里面都有涉及，简单了解一下。</p>
<h3 id="中国剩余定理"><a href="#中国剩余定理" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h3><p>中国剩余定理来源于一个孙子兵法中的问题，问题原话为：<br><em>”有物不知数，三三数之余二，五五数之余三，七七数之余二，问物几何？“</em><br>这其实描述了一个同余方程组问题，后来宋朝数学家秦九韶和明朝数学家程大为都给出了系统的解法，用现在数学语言描述为：<br>$$5\times 7\times 2\times 2 + 3\times 7\times 1\times 3 + 3\times 5\times 1\times 2 = 233 = 2\times 105 + 23$$<br>最小的解为\(23\)。</p>
<p>现代数学语言对中国剩余定理的描述如下：<br>下面一元线性同余方程组：<br>$$\begin{cases}<br>x\equiv a_1\;(mod\;m_1) \\<br>x\equiv a_2\;(mod\;m_2) \\<br>\vdots \\<br>x\equiv a_n\;(mod\;m_n) \\<br>\end{cases}<br>$$<br>假设整数 \(m_1,m_2…m_n\) 两两互质，则对任意整数 \(a_1,a_2…a_n\) 方程组有解，通解可以按照如下方式构造：</p>
<ol>
<li>设\(M=m_1m_2…m_n\)，并且\(M_i=M/m_i\)，由于\(m_1,m_2…m_n\)两两互质，易得\(gcd(M_i,m_i)=1\)。</li>
<li>设\(t_i=M_i^{-1}\)为\(M_i\)在模\(m_i\)上的模倒数，即\(t_iM_i\equiv 1\;(mod\;m_i)\)。</li>
<li>方程组的通解为：\(x=a_1t_1M_1+a_2t_2M_2+…+a_nt_nM_n+kM\)，在模\(M\)的意义下，方程组只有一个解：\(x=(a_1t_1M_1+a_2t_2M_2+…+a_nt_nM_n) \% M\)。</li>
</ol>
<p><strong>证明：</strong><br>首先，\(M_i\)在模\(m_i\)上肯定存在模逆元\(t_i\)就不再证明了，\(t_iM_i\equiv 1\;(mod\;m_i)\)。<br>考察乘积\(a_it_iM_i\)<br>$$<br>a_it_iM_i\equiv a_i·1\equiv a_i\;(mod\;m_i) \\<br>a_it_iM_i\equiv 0\;(mod\;m_j) (i\neq j)<br>$$<br>所以关于\(x=a_1t_1M_1+a_2t_2M_2+…+a_nt_nM_n\)有\(x\equiv a_1t_1M_1+a_2t_2M_2+…+a_nt_nM_n\equiv a_it_iM_i+0\equiv a_i\;(mod\;m_i)\)。<br>所以\(x\)是关于方程组的一个解。<br>若\(x_1,x_2\)都是方程组的解，则根据模运算性质易得\(x_1-x_2\equiv 0\;(mod\;m_i)\)。<br>另\(X=x_1-x_2\)，则由于\(X\equiv 0\;(mod\;m_i)\)，所以\(X\)是所有\(m_i\)的公倍数。<br>又由于\(m_1,m_2…m_n\)两两互质，根据公倍数求解过程，\(m_1,m_2…m_n\)的最小公倍数为\(m_1m_2…m_n\)即\(M\)。<br>所以\(X\)只能是\(M\)的整数倍，即\(X=kM\)。<br>所以两个解之间相差\(kM\)。<br>所以通解为\(x=a_1t_1M_1+a_2t_2M_2+…+a_nt_nM_n+kM\)</p>
<p>中国剩余定理在后面欧拉函数积性的证明里面会用到。</p>
<h3 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h3><p>欧拉函数是小于\(n\)的正整数中与\(n\)互质的数的数目，计作\(\phi(n)\)。<br>比如：\(\phi(2)=1\)，\(\phi(4)=2\)，\(\phi(10)=4\)。<br>至于欧拉函数的计算方法这里不是讨论的重点，基础方法就是枚举小于\(n\)的所有正整数，找出其中与其互质的数并统计个数。<br>欧拉函数有如下性质：<br><strong>1. \(\phi(1)=1\)，\(\phi(2)=1\)，当\(n&gt;2\)时，\(\phi(n)\)一定为偶数。</strong><br><strong>2. \(\phi(p)=p-1\)，\(p\)为质数。</strong><br><strong>3. 若\(n=p^k\)，\(p\)为质数，则\(\phi(n)=\phi(p^k)=p^k-p^{k-1}\)。</strong><br><strong>证明</strong>：若\(n=p^k\)，\(p\)为质数，则不大于\(n\)且与\(n\)互质的数一定不是\(p\)的倍数且只能是这些数，不大于\(n\)的数有\(p^k\)个，其中\(p\)的倍数有\(p^{k-1}\)个\(\{p, 2p, 3p…p^{k-1}p\}\)，所以\(\phi(n)=\phi(p^k)=p^k-p^{k-1}\)。<br><strong>4. 若\(n=p_1p_2\)，且\(p_1,p_2\)互质，那么\(\phi(n)=\phi(p_1)\phi(p_2)\)，这个性质称为欧拉函数的积性。</strong><br><strong>证明</strong>：搜罗了好多资料，关于这条性质的证明非常复杂，大部分都要牵扯到环、域、剩余集这些概念，非常晦涩难懂，并且要钻研的资料会进一步增多，这里秉承浅显通俗的理念，找到了一个相对来说没那么头疼的证明，这里分享一下：<br>原文链接：<a href="http://blog.sina.com.cn/s/blog_455c7a600102vxpq.html" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_455c7a600102vxpq.html</a><br>构造一个矩阵：<br>$$<br>\begin{matrix}<br>1        &amp; 2        &amp; … &amp; r        &amp; … &amp; m \\<br>m+1      &amp; m+2      &amp; … &amp; m+r      &amp; … &amp; 2m \\<br>2m+1     &amp; 2m+2     &amp; … &amp; 2m+r     &amp; … &amp; 3m \\<br>\vdots   &amp; \vdots   &amp;     &amp; \vdots   &amp;     &amp; \vdots \\<br>(n-1)m+1 &amp; (n-1)m+2 &amp; … &amp; (n-1)m+r &amp; … &amp; mn<br>\end{matrix}<br>$$<br>矩阵中所有的数即不大于\(mn\)的所有正整数。<br>由于\(m,n\)互质，所以与\(mn\)互质的整数必与\(m\)和\(n\)互质。<br>考察列：由于\(gcd(km+r,m)=gcd(r,m)\)，所以这些列每一个元素与\(m\)互质的条件为\(r\)与\(m\)互质。<br>这样的\(r\)有\(\phi(m)\)个，选中了矩阵\(\phi(m)\)列。<br>再考察这些列里面的元素：\(\{r, m+r, 2m+r…(n-1)m+r\}\)。<br>根据模运算的性质，这些数在模\(n\)上恰好取遍所有结果。</p>
<blockquote>
<p><strong>展开来说一下</strong>：\(n\)的所有模构成集合\(N=\{0, 1, 2…n-1\}\)，由于\(m\)与\(n\)互质，所以\(mN\)中所有元素在模\(n\)上依旧取遍所有结果。</p>
<blockquote>
<p><strong>证明</strong>：先假设\(mN\)中存在元素\(mn_i,mn_j\)同余，那么\(mn_i-mn_j\equiv 0\;(mod\;n)\)，则\(m(n_i-n_j)=kn\)，由于\(n_i，n_j\)为\(n\)的余数，并且都为正整数，所以\(n_i-n_j\)不可能是\(n\)的倍数，\(m\)又与\(n\)互质，所以假设不可能成立，得证。</p>
</blockquote>
<p>然后\(mN+r\)相当于所有元素在数轴上平移相同单位，不难证明它们模循环移动了相同单位，依旧在模\(n\)上取遍所有结果，得证。</p>
</blockquote>
<p>而这些数中与\(n\)互质的数有\(\phi(n)\)个，所以总数有\(\phi(m)\phi(n)\)个，即\(\phi(mn)=\phi(m)\phi(n)\)，证明完毕。</p>
<p>其他的证明方法理解起来相对困难，这里给几个参考：<br>不使用中国剩余定理<a href="http://www.cnblogs.com/372465774y/archive/2012/10/16/2726282.html" target="_blank" rel="noopener">http://www.cnblogs.com/372465774y/archive/2012/10/16/2726282.html</a></p>
<blockquote>
<p>这篇文章后来想了一下，其实还是比较好理解的一篇，这里展开讲一下。<br>假设\(n,m\)互质，\(N\)为不大于\(n\)且与\(n\)互质的数组成的集合，\(M\)为不大于\(m\)且与\(m\)互质的数组成的集合，\(Z\)为不大于\(mn\)且与\(mn\)互质的数组成的集合。不难发现\(N\)元素有\(\phi(n)\)个，\(M\)元素有\(\phi(m)\)个，\(Z\)元素有\(\phi(mn)\)个。记\(M,N,Z\)中元素分别为\(m_{i},n_{i},z_{i}\)，那么我们要证明的这条定理只需要证明下面几个结论成立即可：</p>
<blockquote>
<p>结论1：\(gcd(n_{i}m+m_{j}n,mn)=1\)。<br>结论2：\(n_{i}m+m_{j}n\)，当\(i，j\)任意一个取值变化的时候，在模\(mn\)下两数不同余。<br>结论3：\(n_{i}m+m_{j}n\)，\(i，j\)取遍\(M,N\)所有元素时，它们在\(mn\)上的模恰好对应\(Z\)中的所有元素。</p>
</blockquote>
<p><strong>首先证明结论1</strong>：因为\(gcd(m_{j},m)=1\)，由于\(m,n\)互质，所以\(gcd(m_{j}n,m)=1\)。<br>又因为\(gcd(m_{j}n+km,m)=gcd(m_{j}n,m)\)，所以\(gcd(m_{j}n+n_{i}m,m)=gcd(m_{j}n,m)=1\)。<br>同理可证\(gcd(n_{i}m+m_{j}n,n)=1\)，所以说\(gcd(n_{i}m+m_{j}n,mn)=1\)。<br><strong>结论2证明</strong>：假设在\(n_{i}m+m_{j}n\)在模\(mn\)下存在同余元素，会得到如下等式<br>$$n_{i}m+m_{j}n\equiv n_{k}m+m_{l}n\;(mod\;mn)$$<br>则有<br>$$\begin{align}<br>&amp;            &amp;n_{i}m+m_{j}n &amp;\equiv n_{k}m+m_{l}n\;(mod\;m) \\<br>&amp;\Rightarrow &amp;m_{j}n         &amp;\equiv m_{l}n\;(mod\;m) \\<br>&amp;\Rightarrow &amp;m_{j}          &amp;\equiv m_{l}\;(mod\;m)<br>\end{align}$$<br>由于\(M\)中元素两两不同余，所以\(j=l\)，同理可证\(i=k\)，所以假设不成立，如果余数相同必定是同一个数。<br>由结论1、2证明可得，\(n_{i}m+m_{j}n\)生成的所有元素与\(mn\)互质且不同余。<br><strong>下面证明结论3</strong>：由于\(gcd(m,n)=1\)，所以存在\(am+bn=1\)，所以有\(amz_{k}+bnz_{k}=z_{k}\)，所以存在\(cm+dn=z_{k}\)。<br>由于\(gcd(z_{k},mn)=1\)，所以\(gcd(cm+dn,m)=1 \Rightarrow gcd(dn,m)=1 \Rightarrow gcd(d,m)=1\)。<br>所以\(d\equiv m_{j}\;(mod\;m) \Rightarrow dn\equiv m_{j}n\;(mod\;m)\)。</p>
<blockquote>
<p><strong>证明</strong>：如果\(d\)在\(m\)上的模不在\(M\)中，余数一定与\(m\)存在公约数设为\(r\)。<br>设\(m=sr\)，余数为\(tr\)。那么\(d=km+tr=(sk+t)r\)，可见\(d\)与\(m\)存在公约数\(r\)与条件相反，假设不成立，得证。</p>
</blockquote>
<p>\(dn=xm+m_{j}n\)，由于\(m,n\)互质，易得\(x\)为\(n\)的倍数，所以\(dn\equiv m_{j}n\;(mod\;mn)\)。<br>同理可得\(cm\equiv n_{i}m\;(mod\;mn)\)。<br>所以\(z_{k}\equiv cm+dn\equiv n_{i}m+m_{j}n\;(mod\;mn)\)，即任意一个\(Z\)中的元素，刚好对应一对\(n_{i},m_{j}\)与之对应同余。<br>这样的元素总数有\(\phi(m)\phi(n)\)个，即\(\phi(mn)=\phi(m)\phi(n)\)，证明完毕。</p>
</blockquote>
<p>这个写的很散，排版也不好<a href="https://www.cnblogs.com/Liisa/p/7228717.html" target="_blank" rel="noopener">https://www.cnblogs.com/Liisa/p/7228717.html</a><br>文库里面的<a href="https://wenku.baidu.com/view/4cf720a8284ac850ad02423c.html" target="_blank" rel="noopener">https://wenku.baidu.com/view/4cf720a8284ac850ad02423c.html</a><br>这个排版稍微好一点<a href="https://weilai5432.github.io/2015/07/29/欧拉函数+中国剩余定理/" target="_blank" rel="noopener">https://weilai5432.github.io/2015/07/29/欧拉函数+中国剩余定理/</a><br>这些证明归根结底是通过中国剩余定理，得到一个关于\(p_1\)的互质同余集与\(p_2\)的互质同余集到\(p_1p_2\)的互质同余集的一个映射关系，当取遍前两者所有元素进行一一配对之后恰好也取遍后者所有元素。<br>如果真的看不懂的话，那就记住这个结论吧……<br><strong>5. 任何整数都可以拆成若干质数的积，所以对于任意整数\(z\)有\(\phi(z)=\phi(p_1^{k_1}p_2^{k_2}…p_n^{k_n})=z(1-\frac{1}{p_1})(1-\frac{1}{p_2})…(1-\frac{1}{p_n})\)</strong><br><strong>证明</strong>：由于\(z=p_1^{k_1}p_2^{k_2}…p_n^{k_n}\)，并且任意两个质数都是互质关系。所以<br>$$\begin{align}<br>\phi(z)&amp;=\phi(p_1^{k_1})\phi(p_2^{k_2})…\phi(p_n^{k_n}) \\<br>       &amp;=p_1^{k_1}(1-\frac{1}{p_1})p_2^{k_2}(1-\frac{1}{p_2})…p_n^{k_n}(1-\frac{1}{p_n}) \\<br>       &amp;=p_1^{k_1}p_2^{k_2}…p_n^{k_n}(1-\frac{1}{p_1})(1-\frac{1}{p_2})…(1-\frac{1}{p_n}) \\<br>       &amp;=z(1-\frac{1}{p_1})(1-\frac{1}{p_2})…(1-\frac{1}{p_n})<br>\end{align}$$</p>
<h3 id="欧拉定理"><a href="#欧拉定理" class="headerlink" title="欧拉定理"></a>欧拉定理</h3><p>欧拉定理内容：若\(n,a\)为正整数，并且\(n,a\)互质，则\(a^{\phi(n)}\equiv 1\;(mod\;n)\)<br><strong>证明</strong>：<br>将\([1,n]\)中与\(n\)互质的数按照从小到大顺序排列，这些数构成集合：\(\{x_1,x_2…x_{\phi(n)}\}\)。<br>考察这些数：\(m_1=ax_1,m_2=ax_2…m_{\phi(n)}=ax_{\phi(n)}\)<br>这些数有如下性质：<br><strong>(1)任意两个数模\(n\)不同余</strong><br>因为若\(m_j-m_i\equiv 0\;(mod\;n)\)，则\(a(x_j-x_i)=kn\)，由于\(x_j-x_i\)一定小于\(n\)不可能是\(n\)的倍数，\(n,a\)互质，所以等式不可能成立。所以任意两个数模\(n\)不同余<br><strong>(2)任意一个数模\(n\)，结果与\(n\)互质</strong><br>因为在\(ax_i\equiv t\;(mod\;n)\)，有\(ax_i=kn+t\)。<br>若\(gcd(t,n)=r\)，假设\(n=pr,t=qr\)，则\(ax_i=(kp+q)r\)。<br>说明\(m_i\)也是\(r\)的倍数，\(ax_i,n\)存在公约数\(r\)。<br>而\(gcd(a,n)=1,gcd(x_i,n)=1\)，所以\(ax_i,n\)的公约数不可能为\(r\)。<br>所以任意一个数模\(n\)，结果与\(n\)互质。<br>由(1)(2)可知，\(ax_1,ax_2…ax_{\phi(n)}\)一定一一对应同余于\(x_1,x_2…x_{\phi(n)}\)<br>则有：\(ax_1⋅ax_2⋅…⋅ax_{\phi(n)}\equiv x_1x_2…x_{\phi(n)}\;(mod\;n)\)。<br>则有：\(a^{\phi(n)}\equiv 1\;(mod\;n)\)，得证。</p>
<p>到这里，RSA的基本原理中的重要定理<strong>欧拉定理</strong>算是从根源到表面完全探究了一遍，下面来看RSA自己的证明。</p>
<h3 id="正篇：RSA算法的证明"><a href="#正篇：RSA算法的证明" class="headerlink" title="正篇：RSA算法的证明"></a>正篇：RSA算法的证明</h3><p>把上面RSA加密算法中出现的各个项目按照刚刚讲所有知识点再表达一遍：\(\phi(n)\)是欧拉函数，\(d,e\)是关于模\(\phi(n)\)的模逆元且\(e,\phi(n)\)互质。<br>再来看加密和解密的公式：<br>$$<br>Encode: S=D^e\;\%\;n \\<br>Decode: D=S^d\;\%\;n<br>$$<br>要证明解密过程的正确性，我们先将它们表示成我们刚刚熟悉的表达形式<br>$$<br>D^e\equiv S\;(mod\;n) \\<br>S^d\equiv D\;(mod\;n)<br>$$<br>加密公式换一种形式：<br>$$<br>D^e=kn+S \Rightarrow S=D^e-kn<br>$$<br>带入到解密式子中<br>$$<br>(D^e-kn)^d\equiv D\;(mod\;n) \Rightarrow D^{de}\equiv D\;(mod\;n)<br>$$<br>由于\(de\equiv 1\;(mod\;\phi(n))\)，所以\(de=t\phi(n) + 1\)。<br>因此问题转化为了证明\(D^{t\phi(n) + 1}\equiv D\;(mod\;n)\)成立。<br>分两种情况讨论<br><strong>(1)若\(D,n\)互质</strong><br>根据欧拉定理有\(D^{\phi(n)}\equiv 1\;(mod\;n)\)，因此\(D^{t\phi(n) + 1}\equiv D\;(mod\;n)\)成立。<br><strong>(2)若\(D,n\)不互质</strong><br>由于\(n=pq\)，\(p,q\)都是质数。<br>所以\(D\)一定是\(p\)或者\(q\)的倍数，并且由于\(D&lt;n\)，\(D\)不会为\(p，q\)的公倍数。<br>所以\(D=hp\)或者\(D=hq\)。<br>这里令\(D=hp\)，容易证明\(D,q\)一定互质。<br>则有：\(D^{\phi(q)}\equiv 1\;(mod\;q)\)。<br>所以：<br>$$\begin{align}<br>&amp;               &amp;(D^{\phi(q)})^{t\phi(p)}           &amp;\equiv 1\;(mod\;q) \\<br>&amp;\Rightarrow    &amp;D^{t\phi(q)\phi(p)}                &amp;\equiv 1\;(mod\;q) \\<br>&amp;\Rightarrow    &amp;D^{t\phi(n) + 1}                   &amp;\equiv D\;(mod\;q) \\<br>&amp;\Rightarrow    &amp;D^{de}                             &amp;\equiv D\;(mod\;q) \\<br>&amp;\Rightarrow    &amp;D^{de}                             &amp;=rq + D<br>\end{align}$$<br>根据假设，\(D\)为\(p\)的倍数，\(p,q\)互质，所以\(r\)为\(p\)的倍数，假设\(rq=spq=sn\)，则有<br>$$<br>D^{de}\equiv sn + D\equiv D\;(mod\;n)<br>$$<br>得证。</p>
<h3 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h3><p>加密算法在安全领域里面是最重要的算法，RSA作为最早的非对称加密算法绝对是具有学习的价值的，后来发展的非对称加密算法或多或少都受到一点RSA算法的影响，或者是在RSA算法基础上的拓展（比如不用整数域改用圆锥曲线上的有限域等）。<br>RSA算法可靠吗？答案是在选取足够大的质数下是很可靠的。<br>我们考察一下RSA在加密信息传递过程的值，可发现只传递加密值\(S\)，\(n\)双方各保留一份，解密所需的私钥为\(d\)，\(d\)泄漏也就意味着泄密，那么有没有可能通过公钥\(e\)和\(n\)推出私钥\(d\)呢？这其实也就是加密的环节泄漏，解密环节是否可以被推知的问题。<br>RSA加密过程中，如果要得到私钥\(d\)，与私钥\(d\)有关的变量只有\(e,\phi(n)\)，\(de\equiv 1\;(mod\;\phi(n))\)。也就是要得到\(\phi(n)\)的值。<br>要计算\(\phi(n)\)，有两种方法，一种是枚举，显然在两个质数足够大的时候这个耗时是不现实的；一种是得知\(n\)算得时的两个质数\(p,q\)，利用欧拉函数性质计算，这样就需要对\(n\)进行因式分解。<br>如果将来发展出一种快速的因式分解方法，那么RSA加密可靠性将大大下降，然而事实是现阶段没有任何一种有效的因式分解方法，所以RSA在现阶段依旧是安全的。<br>目前针对RSA的因式分解，一个是在1999年分解的RSA-155 (512 bits)，花了五个月时间（约8000 MIPS年）和224 CPU hours在一台有3.2G中央内存的Cray C916计算机上完成。一个是在2009年12月12日分解的编号为RSA-768 (768 bits, 232 digits)。这一事件威胁了现通行的1024-bit密钥的安全性，普遍认为用户应尽快升级到2048-bit或以上。<br>所以在现阶段，RSA加密领域在1024位以上是相对安全的。<br>所以从这段描述中，你是不是发现了啥？没错，要实现现阶段可靠的RSA算法，你必须实现大数计算算法，因为现阶段的数据结构中达不到RSA计算要求的位数。<br>也可以说，现阶段实现可靠的RSA加密算法，其实就是实现一个大数运算算法。<br>当然Java有自带类可以帮助完成的，但是那样就感觉有点无聊了。<br>关于大数运算的逻辑，这里不在过多叙述，感兴趣的我这里有一个C#类，除了除法其他的都实现了，想要的可以联系我。</p>
<p>OK，今天就先写到这里，Have a nice day～</p>
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

        </div>
    
</div>


                
                    <!-- Paradox Post Info -->
                    
                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2018/02/26/AES加密/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <!-- 新篇 -->
            AES加密
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2018/02/12/PPPoE服务器编写/" id="post_nav-older" class="next-content">
            <!-- 旧篇 -->
            PPPoE服务器编写
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
</footer>


                    <!-- Import File -->


    <script>lsloader.load("js/lazyload.min.js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==")</script>
    <script>lsloader.load("js/js.min.js","/js/js.min.js?oAl/+lvaqTFV31JXTmbrNA==")</script>



    <script>lsloader.load("js/nprogress.js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==")</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Window Load-->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Bing Background -->


<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.4.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                    <!-- <div id="container"></div> -->
                    <!-- <script src="/js/gitment.browser.js"></script> -->

                    <div id="loadComment" class="post_entry-module mdl-card mdl-shadow--2dp mdl-cell mdl-cell--12-col fade out"  style="background-color: rgba(0, 47, 85, 0.5); min-height: 32px; margin-bottom: 0px;">
                        <center style="margin-top: 6px;">
                            <a href="javascript:loadComment()" title="加载评论" style="color: rgb(129, 248, 228); text-decoration: none;">
                                <span id="BackgroundSwitchTitle">加载评论</span>
                            </a>
                        </center>
                    </div>

                    <!-- <script>
                        function loadComment() {
                            var p_id = 'RSA加密'
                            if (p_id == '')
                                p_id = 'home'
                            var gitment = new Gitment({
                                id: p_id,
                                owner: 'stefenson',
                                repo: 'blog_comment',
                                oauth: {
                                    client_id: '11eae2a971d306a1da92',
                                    client_secret: '4ab3eb2e110d470092f71f89ad8126654048f609',
                                },
                            })
                            gitment.render('container')

                            var lc_btn = document.getElementById("loadComment");
                            var m = document.getElementById("main");
                            m.removeChild(lc_btn);
                        }
                    </script> -->
                </main>
            </div>
            <!-- <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script> -->
            <script type="text/javascript" src="/js/nest.min.js"></script>
            <script type="text/javascript" src="/js/image-zoom.js"></script>
            <script> imgZoomTool.initAt('post-content'); </script>
            <script>
            (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/f5a96f80.js","daovoice")
            daovoice('init', {
                app_id: "f5a96f80"
            });
            daovoice('update');
            </script>
            <style>
            #daodream-container .daodream-sheet-header
            {
                background-image: none;
            }
            </style>
        </body>
    
</html>
